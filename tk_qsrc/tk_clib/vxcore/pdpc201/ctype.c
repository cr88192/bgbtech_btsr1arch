#if 0
/*********************************************************************/
/*                                                                   */
/*  This Program Written by Paul Edwards.                            */
/*  Released to the Public Domain                                    */
/*                                                                   */
/*********************************************************************/
/*********************************************************************/
/*                                                                   */
/*  ctype.c - implementation of stuff in ctype.h                     */
/*                                                                   */
/*********************************************************************/
#endif

#if 1
// #include "stdio.h"
// #include "stddef.h"

#if !defined(__MVS__) && !defined(__CMS__)
// #if 0
static unsigned short __isbufR[257] = {
    0x0000U, /* EOF */
    0x0004U, 0x0004U, 0x0004U, 0x0004U, 0x0004U, 0x0004U, 0x0004U, 0x0004U,
    0x0004U, 0x0104U, 0x0104U, 0x0104U, 0x0104U, 0x0104U, 0x0004U, 0x0004U,
    0x0004U, 0x0004U, 0x0004U, 0x0004U, 0x0004U, 0x0004U, 0x0004U, 0x0004U,
    0x0004U, 0x0004U, 0x0004U, 0x0004U, 0x0004U, 0x0004U, 0x0004U, 0x0004U,
    0x0140U, 0x00D0U, 0x00D0U, 0x00D0U, 0x00D0U, 0x00D0U, 0x00D0U, 0x00D0U,
    0x00D0U, 0x00D0U, 0x00D0U, 0x00D0U, 0x00D0U, 0x00D0U, 0x00D0U, 0x00D0U,
    0x0459U, 0x0459U, 0x0459U, 0x0459U, 0x0459U, 0x0459U, 0x0459U, 0x0459U,
    0x0459U, 0x0459U, 0x00D0U, 0x00D0U, 0x00D0U, 0x00D0U, 0x00D0U, 0x00D0U,
    0x00D0U, 0x0653U, 0x0653U, 0x0653U, 0x0653U, 0x0653U, 0x0653U, 0x0253U,
    0x0253U, 0x0253U, 0x0253U, 0x0253U, 0x0253U, 0x0253U, 0x0253U, 0x0253U,
    0x0253U, 0x0253U, 0x0253U, 0x0253U, 0x0253U, 0x0253U, 0x0253U, 0x0253U,
    0x0253U, 0x0253U, 0x0253U, 0x00D0U, 0x00D0U, 0x00D0U, 0x00D0U, 0x00D0U,
    0x00D0U, 0x0473U, 0x0473U, 0x0473U, 0x0473U, 0x0473U, 0x0473U, 0x0073U,
    0x0073U, 0x0073U, 0x0073U, 0x0073U, 0x0073U, 0x0073U, 0x0073U, 0x0073U,
    0x0073U, 0x0073U, 0x0073U, 0x0073U, 0x0073U, 0x0073U, 0x0073U, 0x0073U,
    0x0073U, 0x0073U, 0x0073U, 0x00D0U, 0x00D0U, 0x00D0U, 0x00D0U, 0x0004U,
    0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U,
    0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U,
    0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U,
    0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U,
    0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U,
    0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U,
    0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U,
    0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U,
    0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U,
    0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U,
    0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U,
    0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U,
    0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U,
    0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U,
    0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U,
    0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U
};

static short __tolowR[257] = {
    -1,
    0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
    0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F,
    0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,
    0x18, 0x19, 0x1A, 0x1B, 0x1C, 0x1D, 0x1E, 0x1F,
    0x20, 0x21, 0x22, 0x23, 0x24, 0x25, 0x26, 0x27,
    0x28, 0x29, 0x2A, 0x2B, 0x2C, 0x2D, 0x2E, 0x2F,
    0x30, 0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37,
    0x38, 0x39, 0x3A, 0x3B, 0x3C, 0x3D, 0x3E, 0x3F,
    0x40, 0x61, 0x62, 0x63, 0x64, 0x65, 0x66, 0x67,
    0x68, 0x69, 0x6A, 0x6B, 0x6C, 0x6D, 0x6E, 0x6F,
    0x70, 0x71, 0x72, 0x73, 0x74, 0x75, 0x76, 0x77,
    0x78, 0x79, 0x7A, 0x5B, 0x5C, 0x5D, 0x5E, 0x5F,
    0x60, 0x61, 0x62, 0x63, 0x64, 0x65, 0x66, 0x67,
    0x68, 0x69, 0x6A, 0x6B, 0x6C, 0x6D, 0x6E, 0x6F,
    0x70, 0x71, 0x72, 0x73, 0x74, 0x75, 0x76, 0x77,
    0x78, 0x79, 0x7A, 0x7B, 0x7C, 0x7D, 0x7E, 0x7F,
    0x80, 0x81, 0x82, 0x83, 0x84, 0x85, 0x86, 0x87,
    0x88, 0x89, 0x8A, 0x8B, 0x8C, 0x8D, 0x8E, 0x8F,
    0x90, 0x91, 0x92, 0x93, 0x94, 0x95, 0x96, 0x97,
    0x98, 0x99, 0x9A, 0x9B, 0x9C, 0x9D, 0x9E, 0x9F,
    0xA0, 0xA1, 0xA2, 0xA3, 0xA4, 0xA5, 0xA6, 0xA7,
    0xA8, 0xA9, 0xAA, 0xAB, 0xAC, 0xAD, 0xAE, 0xAF,
    0xB0, 0xB1, 0xB2, 0xB3, 0xB4, 0xB5, 0xB6, 0xB7,
    0xB8, 0xB9, 0xBA, 0xBB, 0xBC, 0xBD, 0xBE, 0xBF,
    0xC0, 0xC1, 0xC2, 0xC3, 0xC4, 0xC5, 0xC6, 0xC7,
    0xC8, 0xC9, 0xCA, 0xCB, 0xCC, 0xCD, 0xCE, 0xCF,
    0xD0, 0xD1, 0xD2, 0xD3, 0xD4, 0xD5, 0xD6, 0xD7,
    0xD8, 0xD9, 0xDA, 0xDB, 0xDC, 0xDD, 0xDE, 0xDF,
    0xE0, 0xE1, 0xE2, 0xE3, 0xE4, 0xE5, 0xE6, 0xE7,
    0xE8, 0xE9, 0xEA, 0xEB, 0xEC, 0xED, 0xEE, 0xEF,
    0xF0, 0xF1, 0xF2, 0xF3, 0xF4, 0xF5, 0xF6, 0xF7,
    0xF8, 0xF9, 0xFA, 0xFB, 0xFC, 0xFD, 0xFE, 0xFF };

static short __toupR[257] = {
    -1,
    0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
    0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F,
    0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,
    0x18, 0x19, 0x1A, 0x1B, 0x1C, 0x1D, 0x1E, 0x1F,
    0x20, 0x21, 0x22, 0x23, 0x24, 0x25, 0x26, 0x27,
    0x28, 0x29, 0x2A, 0x2B, 0x2C, 0x2D, 0x2E, 0x2F,
    0x30, 0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37,
    0x38, 0x39, 0x3A, 0x3B, 0x3C, 0x3D, 0x3E, 0x3F,
    0x40, 0x41, 0x42, 0x43, 0x44, 0x45, 0x46, 0x47,
    0x48, 0x49, 0x4A, 0x4B, 0x4C, 0x4D, 0x4E, 0x4F,
    0x50, 0x51, 0x52, 0x53, 0x54, 0x55, 0x56, 0x57,
    0x58, 0x59, 0x5A, 0x5B, 0x5C, 0x5D, 0x5E, 0x5F,
    0x60, 0x41, 0x42, 0x43, 0x44, 0x45, 0x46, 0x47,
    0x48, 0x49, 0x4A, 0x4B, 0x4C, 0x4D, 0x4E, 0x4F,
    0x50, 0x51, 0x52, 0x53, 0x54, 0x55, 0x56, 0x57,
    0x58, 0x59, 0x5A, 0x7B, 0x7C, 0x7D, 0x7E, 0x7F,
    0x80, 0x81, 0x82, 0x83, 0x84, 0x85, 0x86, 0x87,
    0x88, 0x89, 0x8A, 0x8B, 0x8C, 0x8D, 0x8E, 0x8F,
    0x90, 0x91, 0x92, 0x93, 0x94, 0x95, 0x96, 0x97,
    0x98, 0x99, 0x9A, 0x9B, 0x9C, 0x9D, 0x9E, 0x9F,
    0xA0, 0xA1, 0xA2, 0xA3, 0xA4, 0xA5, 0xA6, 0xA7,
    0xA8, 0xA9, 0xAA, 0xAB, 0xAC, 0xAD, 0xAE, 0xAF,
    0xB0, 0xB1, 0xB2, 0xB3, 0xB4, 0xB5, 0xB6, 0xB7,
    0xB8, 0xB9, 0xBA, 0xBB, 0xBC, 0xBD, 0xBE, 0xBF,
    0xC0, 0xC1, 0xC2, 0xC3, 0xC4, 0xC5, 0xC6, 0xC7,
    0xC8, 0xC9, 0xCA, 0xCB, 0xCC, 0xCD, 0xCE, 0xCF,
    0xD0, 0xD1, 0xD2, 0xD3, 0xD4, 0xD5, 0xD6, 0xD7,
    0xD8, 0xD9, 0xDA, 0xDB, 0xDC, 0xDD, 0xDE, 0xDF,
    0xE0, 0xE1, 0xE2, 0xE3, 0xE4, 0xE5, 0xE6, 0xE7,
    0xE8, 0xE9, 0xEA, 0xEB, 0xEC, 0xED, 0xEE, 0xEF,
    0xF0, 0xF1, 0xF2, 0xF3, 0xF4, 0xF5, 0xF6, 0xF7,
    0xF8, 0xF9, 0xFA, 0xFB, 0xFC, 0xFD, 0xFE, 0xFF };

#else

static unsigned short __isbufR[257] = {
    0x0000U, /* EOF */
    0x0004U, 0x0004U, 0x0004U, 0x0004U, 0x0004U, 0x0104U, 0x0004U, 0x0004U,
    0x0004U, 0x0004U, 0x0004U, 0x0104U, 0x0104U, 0x0104U, 0x0004U, 0x0004U,
    0x0004U, 0x0004U, 0x0004U, 0x0004U, 0x0004U, 0x0104U, 0x0004U, 0x0004U,
    0x0004U, 0x0004U, 0x0004U, 0x0004U, 0x0004U, 0x0004U, 0x0004U, 0x0004U,
    0x0004U, 0x0004U, 0x0004U, 0x0004U, 0x0004U, 0x0004U, 0x0004U, 0x0004U,
    0x0004U, 0x0000U, 0x0004U, 0x0004U, 0x0004U, 0x0004U, 0x0004U, 0x0004U,
    0x0000U, 0x0000U, 0x0004U, 0x0004U, 0x0004U, 0x0004U, 0x0004U, 0x0004U,
    0x0004U, 0x0004U, 0x0004U, 0x0004U, 0x0004U, 0x0004U, 0x0000U, 0x0004U,
    0x0140U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U,
    0x0000U, 0x0000U, 0x00D0U, 0x00D0U, 0x00D0U, 0x00D0U, 0x00D0U, 0x00D0U,
    0x00D0U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U,
    0x0000U, 0x0000U, 0x00D0U, 0x00D0U, 0x00D0U, 0x00D0U, 0x00D0U, 0x00D0U,
    0x00D0U, 0x00D0U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U,
    0x0000U, 0x0000U, 0x00D0U, 0x00D0U, 0x00D0U, 0x00D0U, 0x00D0U, 0x00D0U,
    0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U,
    0x0000U, 0x00D0U, 0x00D0U, 0x00D0U, 0x00D0U, 0x00D0U, 0x00D0U, 0x00D0U,
    0x0000U, 0x0473U, 0x0473U, 0x0473U, 0x0473U, 0x0473U, 0x0473U, 0x0073U,
    0x0073U, 0x0073U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U,
    0x0000U, 0x0073U, 0x0073U, 0x0073U, 0x0073U, 0x0073U, 0x0073U, 0x0073U,
    0x0073U, 0x0073U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U,
    0x0000U, 0x00D0U, 0x0073U, 0x0073U, 0x0073U, 0x0073U, 0x0073U, 0x0073U,
    0x0073U, 0x0073U, 0x0000U, 0x0000U, 0x0000U, 0x00D0U, 0x0000U, 0x0000U,
    0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U,
    0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x00D0U, 0x0000U, 0x0000U,
    0x00D0U, 0x0653U, 0x0653U, 0x0653U, 0x0653U, 0x0653U, 0x0653U, 0x0253U,
    0x0253U, 0x0253U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U,
    0x00D0U, 0x0253U, 0x0253U, 0x0253U, 0x0253U, 0x0253U, 0x0253U, 0x0253U,
    0x0253U, 0x0253U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U,
    0x00D0U, 0x0000U, 0x0253U, 0x0253U, 0x0253U, 0x0253U, 0x0253U, 0x0253U,
    0x0253U, 0x0253U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U,
    0x0459U, 0x0459U, 0x0459U, 0x0459U, 0x0459U, 0x0459U, 0x0459U, 0x0459U,
    0x0459U, 0x0459U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U, 0x0000U
};

static short __tolowR[257] = {
    -1,
    0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
    0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F,
    0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,
    0x18, 0x19, 0x1A, 0x1B, 0x1C, 0x1D, 0x1E, 0x1F,
    0x20, 0x21, 0x22, 0x23, 0x24, 0x25, 0x26, 0x27,
    0x28, 0x29, 0x2A, 0x2B, 0x2C, 0x2D, 0x2E, 0x2F,
    0x30, 0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37,
    0x38, 0x39, 0x3A, 0x3B, 0x3C, 0x3D, 0x3E, 0x3F,
    0x40, 0x41, 0x42, 0x43, 0x44, 0x45, 0x46, 0x47,
    0x48, 0x49, 0x4A, 0x4B, 0x4C, 0x4D, 0x4E, 0x4F,
    0x50, 0x51, 0x52, 0x53, 0x54, 0x55, 0x56, 0x57,
    0x58, 0x59, 0x5A, 0x5B, 0x5C, 0x5D, 0x5E, 0x5F,
    0x60, 0x61, 0x62, 0x63, 0x64, 0x65, 0x66, 0x67,
    0x68, 0x69, 0x6A, 0x6B, 0x6C, 0x6D, 0x6E, 0x6F,
    0x70, 0x71, 0x72, 0x73, 0x74, 0x75, 0x76, 0x77,
    0x78, 0x79, 0x7A, 0x7B, 0x7C, 0x7D, 0x7E, 0x7F,
    0x80, 0x81, 0x82, 0x83, 0x84, 0x85, 0x86, 0x87,
    0x88, 0x89, 0x8A, 0x8B, 0x8C, 0x8D, 0x8E, 0x8F,
    0x90, 0x91, 0x92, 0x93, 0x94, 0x95, 0x96, 0x97,
    0x98, 0x99, 0x9A, 0x9B, 0x9C, 0x9D, 0x9E, 0x9F,
    0xA0, 0xA1, 0xA2, 0xA3, 0xA4, 0xA5, 0xA6, 0xA7,
    0xA8, 0xA9, 0xAA, 0xAB, 0xAC, 0xAD, 0xAE, 0xAF,
    0xB0, 0xB1, 0xB2, 0xB3, 0xB4, 0xB5, 0xB6, 0xB7,
    0xB8, 0xB9, 0xBA, 0xBB, 0xBC, 0xBD, 0xBE, 0xBF,
    0xC0, 0x81, 0x82, 0x83, 0x84, 0x85, 0x86, 0x87,
    0x88, 0x89, 0xCA, 0xCB, 0xCC, 0xCD, 0xCE, 0xCF,
    0xD0, 0x91, 0x92, 0x93, 0x94, 0x95, 0x96, 0x97,
    0x98, 0x99, 0xDA, 0xDB, 0xDC, 0xDD, 0xDE, 0xDF,
    0xE0, 0xE1, 0xA2, 0xA3, 0xA4, 0xA5, 0xA6, 0xA7,
    0xA8, 0xA9, 0xEA, 0xEB, 0xEC, 0xED, 0xEE, 0xEF,
    0xF0, 0xF1, 0xF2, 0xF3, 0xF4, 0xF5, 0xF6, 0xF7,
    0xF8, 0xF9, 0xFA, 0xFB, 0xFC, 0xFD, 0xFE, 0xFF };

static short __toupR[257] = {
    -1,
    0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
    0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F,
    0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,
    0x18, 0x19, 0x1A, 0x1B, 0x1C, 0x1D, 0x1E, 0x1F,
    0x20, 0x21, 0x22, 0x23, 0x24, 0x25, 0x26, 0x27,
    0x28, 0x29, 0x2A, 0x2B, 0x2C, 0x2D, 0x2E, 0x2F,
    0x30, 0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37,
    0x38, 0x39, 0x3A, 0x3B, 0x3C, 0x3D, 0x3E, 0x3F,
    0x40, 0x41, 0x42, 0x43, 0x44, 0x45, 0x46, 0x47,
    0x48, 0x49, 0x4A, 0x4B, 0x4C, 0x4D, 0x4E, 0x4F,
    0x50, 0x51, 0x52, 0x53, 0x54, 0x55, 0x56, 0x57,
    0x58, 0x59, 0x5A, 0x5B, 0x5C, 0x5D, 0x5E, 0x5F,
    0x60, 0x61, 0x62, 0x63, 0x64, 0x65, 0x66, 0x67,
    0x68, 0x69, 0x6A, 0x6B, 0x6C, 0x6D, 0x6E, 0x6F,
    0x70, 0x71, 0x72, 0x73, 0x74, 0x75, 0x76, 0x77,
    0x78, 0x79, 0x7A, 0x7B, 0x7C, 0x7D, 0x7E, 0x7F,
    0x80, 0xC1, 0xC2, 0xC3, 0xC4, 0xC5, 0xC6, 0xC7,
    0xC8, 0xC9, 0x8A, 0x8B, 0x8C, 0x8D, 0x8E, 0x8F,
    0x90, 0xD1, 0xD2, 0xD3, 0xD4, 0xD5, 0xD6, 0xD7,
    0xD8, 0xD9, 0x9A, 0x9B, 0x9C, 0x9D, 0x9E, 0x9F,
    0xA0, 0xA1, 0xE2, 0xE3, 0xE4, 0xE5, 0xE6, 0xE7,
    0xE8, 0xE9, 0xAA, 0xAB, 0xAC, 0xAD, 0xAE, 0xAF,
    0xB0, 0xB1, 0xB2, 0xB3, 0xB4, 0xB5, 0xB6, 0xB7,
    0xB8, 0xB9, 0xBA, 0xBB, 0xBC, 0xBD, 0xBE, 0xBF,
    0xC0, 0xC1, 0xC2, 0xC3, 0xC4, 0xC5, 0xC6, 0xC7,
    0xC8, 0xC9, 0xCA, 0xCB, 0xCC, 0xCD, 0xCE, 0xCF,
    0xD0, 0xD1, 0xD2, 0xD3, 0xD4, 0xD5, 0xD6, 0xD7,
    0xD8, 0xD9, 0xDA, 0xDB, 0xDC, 0xDD, 0xDE, 0xDF,
    0xE0, 0xE1, 0xE2, 0xE3, 0xE4, 0xE5, 0xE6, 0xE7,
    0xE8, 0xE9, 0xEA, 0xEB, 0xEC, 0xED, 0xEE, 0xEF,
    0xF0, 0xF1, 0xF2, 0xF3, 0xF4, 0xF5, 0xF6, 0xF7,
    0xF8, 0xF9, 0xFA, 0xFB, 0xFC, 0xFD, 0xFE, 0xFF };

#endif

// unsigned short *__isbuf = &__isbufR[1];
// short *__tolow = &__tolowR[1];
// short *__toup = &__toupR[1];

// unsigned short *__isbuf;
unsigned short *__isbuf = NULL;

// #ifndef __BJX2__
#if 1
short *__tolow = NULL;
short *__toup = NULL;
#endif

extern short locale_id;
extern int locale_flags;


int _tolower_gen(int c);
int _toupper_gen(int c);

void __cytpe_init(void)
{
	int i;

	if(__isbuf)
		return;

//	setlocale(1, "");

	__isbuf = &__isbufR[1];

// #ifndef __BJX2__
#if 1
	__tolow = &__tolowR[1];
	__toup = &__toupR[1];
#endif

	setlocale(1, "");

#if 1
	__tolow[-1]=-1;
	__toup[-1]=-1;
	for(i=0; i<256; i++)
	{
		__tolow[i]=_tolower_gen(i);
		__toup[i]=_toupper_gen(i);
	}
#endif
}

#endif

__PDPCLIB_API__ int isascii(int c)
{
	if(c<0x00)
		return(0);
	if(c>0x7F)
		return(0);
	return(1);
}

__PDPCLIB_API__ int isalnum(int c)
{
	__cytpe_init();
	if(c<0)
		c=-1;
	if(c<=0xFF)
		return (__isbuf[c] & 0x0001U);
	return(isalpha(c)||isdigit(c));
}

__PDPCLIB_API__ int isalpha(int c)
{
	__cytpe_init();
	if(c<0)
		c=-1;
	if(c<=0xFF)
		return (__isbuf[c] & 0x0002U);
	return(0);
}

__PDPCLIB_API__ int iscntrl(int c)
{
	__cytpe_init();
	if(c<0)
		c=-1;
	if(c<=0xFF)
		return (__isbuf[c] & 0x0004U);
	return(0);
}

__PDPCLIB_API__ int isdigit(int c)
{
	__cytpe_init();
	if(c<0)
		c=-1;
	if(c<=0xFF)
		return (__isbuf[c] & 0x0008U);
	return(0);
}

__PDPCLIB_API__ int isgraph(int c)
{
	__cytpe_init();
	if(c<0)
		c=-1;
	if(c<=0xFF)
		return (__isbuf[c] & 0x0010U);
	return(0);
}

__PDPCLIB_API__ int islower(int c)
{
	__cytpe_init();
	if(c<0)
		c=-1;
	if(c<=0xFF)
		return (__isbuf[c] & 0x0020U);
	return(0);
}

__PDPCLIB_API__ int isprint(int c)
{
	__cytpe_init();
	if(c<0)
		c=-1;
	if(c<=0xFF)
		return (__isbuf[c] & 0x0040U);
	return(0);
}

__PDPCLIB_API__ int ispunct(int c)
{
	__cytpe_init();
	if(c<0)
		c=-1;
	if(c<=0xFF)
		return (__isbuf[c] & 0x0080U);

	return(!isspace(c) && !isalnum(c));
//	return(0);
}

__PDPCLIB_API__ int isspace(int c)
{
	__cytpe_init();
	if(c<0)
		c=-1;
	if(c<=0xFF)
		return (__isbuf[c] & 0x0100U);
	return(0);
}

__PDPCLIB_API__ int isupper(int c)
{
	__cytpe_init();
	if(c<0)
		c=-1;
	if(c<=0xFF)
		return (__isbuf[c] & 0x0200U);
	return(0);
}

__PDPCLIB_API__ int isxdigit(int c)
{
	__cytpe_init();
	if(c<0)
		c=-1;
	if(c<=0xFF)
		return (__isbuf[c] & 0x0400U);
	return(0);
}

// TK_NOCULL
int _tolower_gen(int c)
{
	if(c<=0x7F)
	{
		if((c>='A') && (c<='Z'))
			return(c+0x20);
		return(c);
	}

	if((c>=0xA0) && (c<=0xD6))
	{
		return(c+0x20);
	}
	
	if((c>=0xD8) && (c<=0xDE))
	{
		return(c+0x20);
	}
	
//	if(_locale_is_cp1252())
	if(locale_flags&TK_LOCALE_FLAG_CP1252)
	{
		if(c==0x8A)
			return(0x9A);
		if(c==0x8C)
			return(0x9C);
		if(c==0x8E)
			return(0x9E);
		if(c==0x9F)
			return(0xFF);
	}
	
	if((c>=0x0391) && (c<=0x03AA))
		return(c+0x20);

	if((c>=0x0400) && (c<=0x040F))
		return(c+0x50);
	if((c>=0x0410) && (c<=0x042F))
		return(c+0x20);

	return(c);
}

// TK_NOCULL
int _toupper_gen(int c)
{
	if(c<=0x7F)
	{
		if((c>='a') && (c<='z'))
			return(c-0x20);
		return(c);
	}

	if((c>=0xE0) && (c<=0xF6))
	{
		return(c-0x20);
	}

	if((c>=0xF8) && (c<=0xFE))
	{
		return(c+0x20);
	}
	
//	if(_locale_is_cp1252())
	if(locale_flags&TK_LOCALE_FLAG_CP1252)
	{
		if(c==0x9A)
			return(0x8A);
		if(c==0x9C)
			return(0x8C);
		if(c==0x9E)
			return(0x8E);
		if(c==0xFF)
			return(0x9F);
	}

	if(c==0xFF)
		return(0x178);

	if((c>=0x03B1) && (c<=0x03CA))
		return(c-0x20);

	if((c>=0x0450) && (c<=0x045F))
		return(c-0x50);
	if((c>=0x0430) && (c<=0x044F))
		return(c-0x20);

	return(c);
}

#ifdef __BJX2__

__PDPCLIB_API__ int tolower(int c);
__PDPCLIB_API__ int toupper(int c);

__asm {
tolower:
	TEST	0xFF80, R4
	BF		.L0
	MOV		R4, R2
	SUB		R4, 0x41, R3
	CMPHI	25, R3
	ADD?F	32, R2
	RTS
	.L0:
	BRA		_tolower_gen

toupper:
	TEST	0xFF80, R4
	BF		.L0
	MOV		R4, R2
	SUB		R4, 0x61, R3
	CMPHI	25, R3
	ADD?F	-32, R2
	RTS
	.L0:
	BRA		_toupper_gen
};

#else

__PDPCLIB_API__ int tolower(int c)
{
	return(_tolower_gen(c));

#if 0
	if(!__tolow)
		__cytpe_init();
	return (__tolow[c]);
#endif
}

__PDPCLIB_API__ int toupper(int c)
{
	return(_toupper_gen(c));

#if 0
	if(!__toup)
		__cytpe_init();
	return (__toup[c]);
#endif
}
#endif

#ifdef __BJX2__
//#if 0

__PDPCLIB_API__ uint64_t _toupper_8x(uint64_t c);
__PDPCLIB_API__ uint64_t _tolower_8x(uint64_t c);

__asm {

#if 0

_tolower_8x:
#if 0
//	MOV		0x4141414141414141, R3
//	MOV		R4, R2			|	PSUB.W R4, R3, R5
	MOV		R4, R2			|	MOV R4, R5
	SUB		0x4141414141414141, R5
	SHLD.Q	R5, -8, R17		|	EXTU.B	R5, R16
	SHLD.Q	R5, -16, R18	|	EXTU.B	R17, R17
	SHLD.Q	R5, -24, R19	|	EXTU.B	R18, R18
	SHLD.Q	R5, -32, R20	|	EXTU.B	R19, R19
	SHLD.Q	R5, -40, R21	|	EXTU.B	R20, R20
	SHLD.Q	R5, -48, R22	|	EXTU.B	R21, R21
	SHLD.Q	R5, -56, R23	|	EXTU.B	R22, R22
	EXTU.B	R23, R23
	CMPHI	25, R16
	ADD?F	0x0000000000000020, R2
	CMPHI	25, R17
	ADD?F	0x0000000000002000, R2
	CMPHI	25, R18
	ADD?F	0x0000000000200000, R2
	CMPHI	25, R19
	ADD?F	0x0000000020000000, R2
	CMPHI	25, R20
	ADD?F	0x0000002000000000, R2
	CMPHI	25, R21
	ADD?F	0x0000200000000000, R2
	CMPHI	25, R22
	ADD?F	0x0020000000000000, R2
	CMPHI	25, R23
	ADD?F	0x2000000000000000, R2
	RTS
#endif

#if 1
	MOV		R4, R2			|	SHLD.Q	R4, -8, R17		|	EXTU.B	R4, R16
	SUB		R16, 0x41, R16	|	SHLD.Q	R4, -16, R18	|	EXTU.B	R17, R17
	SUB		R17, 0x41, R17	|	SHLD.Q	R4, -24, R19	|	EXTU.B	R18, R18
	SUB		R18, 0x41, R18	|	SHLD.Q	R4, -32, R20	|	EXTU.B	R19, R19
	SUB		R19, 0x41, R19	|	SHLD.Q	R4, -40, R21	|	EXTU.B	R20, R20
	SUB		R20, 0x41, R20	|	SHLD.Q	R4, -48, R22	|	EXTU.B	R21, R21
	SUB		R21, 0x41, R21	|	SHLD.Q	R4, -56, R23	|	EXTU.B	R22, R22
	SUB		R22, 0x41, R22	|	SUB		R23, 0x41, R23
	MOV		0x20, R3		|	CMPHI	25, R16
								ADD?F	R3, R2
	SHLD.Q	R3, 8, R3		|	CMPHI	25, R17
								ADD?F	R3, R2
	SHLD.Q	R3, 8, R3		|	CMPHI	25, R18
								ADD?F	R3, R2
	SHLD.Q	R3, 8, R3		|	CMPHI	25, R19
								ADD?F	R3, R2
	SHLD.Q	R3, 8, R3		|	CMPHI	25, R20
								ADD?F	R3, R2
	SHLD.Q	R3, 8, R3		|	CMPHI	25, R21
								ADD?F	R3, R2
	SHLD.Q	R3, 8, R3		|	CMPHI	25, R22
								ADD?F	R3, R2
	SHLD.Q	R3, 8, R3		|	CMPHI	25, R23
								ADD?F	R3, R2
	RTS
#endif


#if 0
_toupper_8x:
	MOV		0x8080808080808080, R5
	TSTQ	R5, R4
	BF		_toupper_8x_tab

#if 0
//	MOV		0x6161616161616161, R3
//	MOV		R4, R2			|	PSUB.W R4, R3, R5
	MOV		R4, R2			|	MOV R4, R5
	SUB		0x6161616161616161, R5
	SHLD.Q	R5, -8, R17		|	EXTU.B	R5, R16
	SHLD.Q	R5, -16, R18	|	EXTU.B	R17, R17
	SHLD.Q	R5, -24, R19	|	EXTU.B	R18, R18
	SHLD.Q	R5, -32, R20	|	EXTU.B	R19, R19
	SHLD.Q	R5, -40, R21	|	EXTU.B	R20, R20
	SHLD.Q	R5, -48, R22	|	EXTU.B	R21, R21
	SHLD.Q	R5, -56, R23	|	EXTU.B	R22, R22
#endif

#if 1
	MOV		R4, R2			|	SHLD.Q	R4, -8, R17		|	EXTU.B	R4, R16
	SUB		R16, 0x61, R16	|	SHLD.Q	R4, -16, R18	|	EXTU.B	R17, R17
	SUB		R17, 0x61, R17	|	SHLD.Q	R4, -24, R19	|	EXTU.B	R18, R18
	SUB		R18, 0x61, R18	|	SHLD.Q	R4, -32, R20	|	EXTU.B	R19, R19
	SUB		R19, 0x61, R19	|	SHLD.Q	R4, -40, R21	|	EXTU.B	R20, R20
	SUB		R20, 0x61, R20	|	SHLD.Q	R4, -48, R22	|	EXTU.B	R21, R21
	SUB		R21, 0x61, R21	|	SHLD.Q	R4, -56, R23	|	EXTU.B	R22, R22
	SUB		R22, 0x61, R22	|	SUB		R23, 0x61, R23
#endif

//	EXTU.B	R23, R23
	MOV		-32, R3			|	CMPHI	25, R16
								ADD?F	R3, R2
	SHLD.Q	R3, 8, R3		|	CMPHI	25, R17
								ADD?F	R3, R2
	SHLD.Q	R3, 8, R3		|	CMPHI	25, R18
								ADD?F	R3, R2
	SHLD.Q	R3, 8, R3		|	CMPHI	25, R19
								ADD?F	R3, R2
	SHLD.Q	R3, 8, R3		|	CMPHI	25, R20
								ADD?F	R3, R2
	SHLD.Q	R3, 8, R3		|	CMPHI	25, R21
								ADD?F	R3, R2
	SHLD.Q	R3, 8, R3		|	CMPHI	25, R22
								ADD?F	R3, R2
	SHLD.Q	R3, 8, R3		|	CMPHI	25, R23
								ADD?F	R3, R2
	RTS
#endif

#endif

_tolower_8x:
// _toupper_8x_tab:
	MOV.P		__tolow, R5

	SHLD.Q	R4, -8, R17		|	EXTU.B	R4, R16
	SHLD.Q	R4, -16, R18	|	EXTU.B	R17, R17
	SHLD.Q	R4, -24, R19	|	EXTU.B	R18, R18
	SHLD.Q	R4, -32, R20	|	EXTU.B	R19, R19
	SHLD.Q	R4, -40, R21	|	EXTU.B	R20, R20
	SHLD.Q	R4, -48, R22	|	MOV.W	(R5, R16), R16
	SHLD.Q	R4, -56, R23	|	MOV.W	(R5, R17), R17
	EXTU.B	R21, R21		|	MOV.W	(R5, R18), R18
	EXTU.B	R22, R22		|	MOV.W	(R5, R19), R19
	SHLD.Q	R17, 8, R17		|	MOV.W	(R5, R20), R20
	SHLD.Q	R18, 16, R18	|	MOV.W	(R5, R21), R21
	SHLD.Q	R19, 24, R19	|	MOV.W	(R5, R22), R22
	SHLD.Q	R20, 32, R20	|	MOV.W	(R5, R23), R23
	SHLD.Q	R21, 40, R21	|
	SHLD.Q	R22, 48, R22	|	SHLD.Q	R23, 56, R23

	OR		R16, R17, R16	|	OR		R18, R19, R18
	OR		R20, R21, R20	|	OR		R22, R23, R22
	OR		R16, R18, R16	|	OR		R20, R22, R17
	OR		R16, R17, R2
	RTS

_toupper_8x:

#if 1
// _toupper_8x_tab:
	MOV.P		__toup, R5

	SHLD.Q	R4, -8, R17		|	EXTU.B	R4, R16
	SHLD.Q	R4, -16, R18	|	EXTU.B	R17, R17
	SHLD.Q	R4, -24, R19	|	EXTU.B	R18, R18
	SHLD.Q	R4, -32, R20	|	EXTU.B	R19, R19
	SHLD.Q	R4, -40, R21	|	EXTU.B	R20, R20
	SHLD.Q	R4, -48, R22	|	MOV.W	(R5, R16), R16
	SHLD.Q	R4, -56, R23	|	MOV.W	(R5, R17), R17
	EXTU.B	R21, R21		|	MOV.W	(R5, R18), R18
	EXTU.B	R22, R22		|	MOV.W	(R5, R19), R19
	SHLD.Q	R17, 8, R17		|	MOV.W	(R5, R20), R20
	SHLD.Q	R18, 16, R18	|	MOV.W	(R5, R21), R21
	SHLD.Q	R19, 24, R19	|	MOV.W	(R5, R22), R22
	SHLD.Q	R20, 32, R20	|	MOV.W	(R5, R23), R23
	SHLD.Q	R21, 40, R21	|
	SHLD.Q	R22, 48, R22	|	SHLD.Q	R23, 56, R23

	OR		R16, R17, R16	|	OR		R18, R19, R18
	OR		R20, R21, R20	|	OR		R22, R23, R22
	OR		R16, R18, R16	|	OR		R20, R22, R17
	OR		R16, R17, R2
	RTS
#endif
};

#else

uint64_t _tolower_8x(uint64_t c)
{
	uint64_t v;
	v=         tolower((c>>56)&0xFF);
	v=(v<<8) | tolower((c>>48)&0xFF);
	v=(v<<8) | tolower((c>>40)&0xFF);
	v=(v<<8) | tolower((c>>32)&0xFF);
	v=(v<<8) | tolower((c>>24)&0xFF);
	v=(v<<8) | tolower((c>>16)&0xFF);
	v=(v<<8) | tolower((c>> 8)&0xFF);
	v=(v<<8) | tolower((c>> 0)&0xFF);
	return(v);
}

uint64_t _toupper_8x(uint64_t c)
{
	uint64_t v;
	v=         toupper((c>>56)&0xFF);
	v=(v<<8) | toupper((c>>48)&0xFF);
	v=(v<<8) | toupper((c>>40)&0xFF);
	v=(v<<8) | toupper((c>>32)&0xFF);
	v=(v<<8) | toupper((c>>24)&0xFF);
	v=(v<<8) | toupper((c>>16)&0xFF);
	v=(v<<8) | toupper((c>> 8)&0xFF);
	v=(v<<8) | toupper((c>> 0)&0xFF);
	return(v);
}

#endif
